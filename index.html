<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TicTacToe</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div class="container">
    <div id="first" class="field" onclick="first()"></div>
    <div id="second" onclick="second()" class="field"></div>
    <div id="third" onclick="third()" class="field"></div>
    <div style="clear:both;"></div>

    <div id="fourth" onclick="fourth()" class="field"></div>
    <div id="fifth" onclick="fifth()" class="field"></div>
    <div id="sixth" onclick="sixth()" class="field"></div>
    <div style="clear:both;"></div>

    <div id="seventh" onclick="seventh()" class="field"></div>
    <div id="eighth" onclick="eighth()" class="field"></div>
    <div id="ninth" onclick="ninth()" class="field"></div>
    <div style="clear:both;"></div>

    <p class="content" id="communicatesToPlayer">Aby zacząć kliknij w miejsce, gdzie chcesz umieścić kółko.</p>
</div>

<script>
    var isFieldFull = [false, false, false, false, false, false, false, false, false];
    var playersMoves = [false, false, false, false, false, false, false, false, false];
    var computerMoves = [false, false, false, false, false, false, false, false, false];

    var numberOfMoves = 0;
    var isGameOver = false;

    var crossIcon = document.createElement("img");
    crossIcon.src = "cross.png";

    var pluralForms = ["first", "second", "third", "fourth", "fifth", "sixth", "seventh", "eighth", "ninth"];

    function checkIfSomeoneWins(array, string) {
        if ((array[0] && array[1] && array[2]) ||
                (array[3] && array[4] && array[5]) ||
                (array[6] && array[7] && array[8]) ||
                (array[0] && array[3] && array[6]) ||
                (array[1] && array[4] && array[7]) ||
                (array[2] && array[5] && array[8]) ||
                (array[0] && array[4] && array[8]) ||
                (array[2] && array[4] && array[6])) {
            document.getElementById("communicatesToPlayer").innerHTML = string + " wygrał!";
            isGameOver = true;
            for (var n in isFieldFull) {
                isFieldFull[n] = true;
            }
        }
        else if (numberOfMoves == 9) {
            for (var h in isFieldFull) {
                isFieldFull[h] = true;
                isGameOver = true;
            }
            document.getElementById("communicatesToPlayer").innerHTML = "Remis!";
        }
    }

    function setComputersMove(number, fieldIndex) {
        var crossIcon = document.createElement("img");
        crossIcon.src = "cross.png";
        var index = document.getElementById(fieldIndex);
        index.appendChild(crossIcon);
        isFieldFull[number] = true;
        computerMoves[number] = true;
    }

    function computerMove() { //TODO losowac z kolekcji pustych pol, a nie ze wszystkich
        while (true) {
            if (!isGameOver) {
                var number = Math.floor(Math.random() * 9);
                console.log(number);
                if (!isFieldFull[number]) {
                    setComputersMove(number, pluralForms[number]);
                    numberOfMoves++;
                    checkIfSomeoneWins(computerMoves, "Przeciwnik");
                    break;
                }
            }
            else {
                break;
            }
        }
    }

    function setPlayersMove(number, indexOfField) {
        if (isFieldFull[number] == false) {
            var circleIcon = document.createElement("img");
            circleIcon.src = "circle.png";
            var src = document.getElementById(indexOfField);
            src.appendChild(circleIcon);
            isFieldFull[number] = true;
            playersMoves[number] = true;
            numberOfMoves++;
            checkIfSomeoneWins(playersMoves, "Gracz");
            computerMove();
        }
        else {
            document.getElementById("communicatesToPlayer").innerHTML = "Nie możesz postawić tu znaku.";
        }
    }
    function first() {
        setPlayersMove(0, pluralForms[0]);
    }

    function second() {
        setPlayersMove(1, pluralForms[1]);
    }

    function third() {
        setPlayersMove(2, pluralForms[2]);
    }

    function fourth() {
        setPlayersMove(3, pluralForms[3]);
    }

    function fifth() {
        setPlayersMove(4, pluralForms[4]);
    }

    function sixth() {
        setPlayersMove(5, pluralForms[5]);
    }

    function seventh() {
        setPlayersMove(6, pluralForms[6]);
    }

    function eighth() {
        setPlayersMove(7, pluralForms[7]);
    }

    function ninth() {
        setPlayersMove(8, pluralForms[8]);
    }

</script>
</body>
</html>